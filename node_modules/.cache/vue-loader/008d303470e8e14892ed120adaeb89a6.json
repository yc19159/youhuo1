{"remainingRequest":"D:\\11.23\\demo\\youhuo1\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\11.23\\demo\\youhuo1\\src\\components\\Uploadavatar.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\11.23\\demo\\youhuo1\\src\\components\\Uploadavatar.vue","mtime":1574148250283},{"path":"D:\\11.23\\demo\\youhuo1\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\11.23\\demo\\youhuo1\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\11.23\\demo\\youhuo1\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\11.23\\demo\\youhuo1\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n\n function isPicFile(fileName) {\n        //lastIndexOf如果没有搜索到则返回为 -1\n        if (fileName.lastIndexOf(\".\") != -1) {\n            var fileType = (fileName.substring(fileName.lastIndexOf(\".\") + 1, fileName.length)).toLowerCase();\n            var suppotFile = new Array();\n                suppotFile[0] = \"jpg\";\n                suppotFile[1] = \"gif\";\n                suppotFile[2] = \"bmp\";\n                suppotFile[3] = \"png\";\n                suppotFile[4] = \"jpeg\";\n            for ( var i = 0; i < suppotFile.length; i++) {\n                if (suppotFile[i] == fileType) {\n                    return true;\n                } else {\n                    continue;\n                }\n            }\n            alert(\"文件类型不合法,只能是jpg、gif、bmp、png、jpeg、png类型！\");\n            return false;\n        } else {\n            alert(\"文件类型不合法,只能是 jpg、gif、bmp、png、jpeg、png类型！\");\n            return false;\n        }\n    }\nexport default {\n    data(){\n        return {\n            touxiang:\"\",\n        }\n    },\n    methods:{\n        uploadImg(){\n            this.$refs.upload.click();\n        },\n        shangchuan(){\n            console.log(\"准备上传...\");\n            let file = this.$refs.upload.files[0];\n            console.log(file);\n            // 表单  Form    name \n            let data = new FormData() ;  // 新建 表单对象  \n           \n            data.append('file',file);\n            console.log(data)\n            // isPicFile(file)\n            // let data={\n\n            //     file: file,\n            // }\n            this.$axios({\n                url:\"/user/uploadAvatar\",\n                method:\"POST\",\n                data:data,\n                // contentType:false,\n                // processData:false,\n            }).then(res=>{\n                //  this.touxiang =res.data.data.avatarUrl;   // 配置代理 \n                console.log(res);\n                this.$axios.post(\"/user/info\").then(res=>{\n            console.log(res.data.data.avatarUrl)\n                  if(res.data.data.avatarUrl){\n                      console.log(res.data.data.avatarUrl)\n                      this.touxiang = res.data.data.avatarUrl;\n                    //   this.$refs.touxiang.src= \"http://192.168.0.18:8080/zubei/users/img/9a0be563-2daf-4391-b2a3-27485e251849.jpg\";\n                      console.log(this.touxiang);\n                  }else{\n                      this.touxiang = require(\"@/assets/image/touxiang.jpg\");\n                  }\n            })\n                // this.touxiang = res.data.pic.replace(/public/,'http://192.168.0.24:8080');  //不需要配置代理 \n                // localStorage.avatar = this.touxiang;\n            })\n\n            // processData: false,//默认情况下，通过data选项传递进来的数据，如果是一个对象(技术上讲只要不是字符串)，都会处理转化成一个查询字符串，以配合默认内容类型 \"application/x-www-form-urlencoded\"。如果要发送 DOM 树信息或其它不希望转换的信息，请设置为 false。\n            // contentType: false,//数据编码格式不使用jquery的方式 为了避免 JQuery 对其操作，从而失去分界符，而使服务器不能正常解析文件。data:formData,\n        }\n    },\n    mounted(){\n        // if(localStorage.avatar){\n        //     this.touxiang = localStorage.avatar;\n        // }else{\n        //     // 使用默认 \n        //     this.touxiang = require(\"@/assets/images/img4.jpg\");\n        // }\n        this.$axios.post(\"/user/info\").then(res=>{\n            console.log(res.data.data.avatarUrl)\n                  if(res.data.data.avatarUrl){\n                      console.log(res.data.data.avatarUrl)\n                      this.touxiang = res.data.data.avatarUrl;\n                    //   this.$refs.touxiang.src= \"http://192.168.0.18:8080/zubei/users/img/9a0be563-2daf-4391-b2a3-27485e251849.jpg\";\n                      console.log(this.touxiang);\n                  }else{\n                      this.touxiang = require(\"@/assets/image/touxiang.jpg\");\n                  }\n            })\n        \n    }\n}\n",{"version":3,"sources":["Uploadavatar.vue"],"names":[],"mappings":";;;;;;;;;;AAUA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA","file":"Uploadavatar.vue","sourceRoot":"src/components","sourcesContent":["<template>\r\n    <!-- <div id=\"photo\"> -->\r\n        <div class=\"tx-img\">\r\n        <img :src=\"touxiang\" alt=\"\" @click=\"uploadImg\"  class=\"userImg\" ref=\"touxiang\">\r\n        <input @change=\"shangchuan\" type=\"file\" ref=\"upload\" accept=\"image/*\" class=\"hiddenInput\">\r\n        \r\n    </div>\r\n</template>\r\n\r\n<script>\r\n function isPicFile(fileName) {\r\n        //lastIndexOf如果没有搜索到则返回为 -1\r\n        if (fileName.lastIndexOf(\".\") != -1) {\r\n            var fileType = (fileName.substring(fileName.lastIndexOf(\".\") + 1, fileName.length)).toLowerCase();\r\n            var suppotFile = new Array();\r\n                suppotFile[0] = \"jpg\";\r\n                suppotFile[1] = \"gif\";\r\n                suppotFile[2] = \"bmp\";\r\n                suppotFile[3] = \"png\";\r\n                suppotFile[4] = \"jpeg\";\r\n            for ( var i = 0; i < suppotFile.length; i++) {\r\n                if (suppotFile[i] == fileType) {\r\n                    return true;\r\n                } else {\r\n                    continue;\r\n                }\r\n            }\r\n            alert(\"文件类型不合法,只能是jpg、gif、bmp、png、jpeg、png类型！\");\r\n            return false;\r\n        } else {\r\n            alert(\"文件类型不合法,只能是 jpg、gif、bmp、png、jpeg、png类型！\");\r\n            return false;\r\n        }\r\n    }\r\nexport default {\r\n    data(){\r\n        return {\r\n            touxiang:\"\",\r\n        }\r\n    },\r\n    methods:{\r\n        uploadImg(){\r\n            this.$refs.upload.click();\r\n        },\r\n        shangchuan(){\r\n            console.log(\"准备上传...\");\r\n            let file = this.$refs.upload.files[0];\r\n            console.log(file);\r\n            // 表单  Form    name \r\n            let data = new FormData() ;  // 新建 表单对象  \r\n           \r\n            data.append('file',file);\r\n            console.log(data)\r\n            // isPicFile(file)\r\n            // let data={\r\n\r\n            //     file: file,\r\n            // }\r\n            this.$axios({\r\n                url:\"/user/uploadAvatar\",\r\n                method:\"POST\",\r\n                data:data,\r\n                // contentType:false,\r\n                // processData:false,\r\n            }).then(res=>{\r\n                //  this.touxiang =res.data.data.avatarUrl;   // 配置代理 \r\n                console.log(res);\r\n                this.$axios.post(\"/user/info\").then(res=>{\r\n            console.log(res.data.data.avatarUrl)\r\n                  if(res.data.data.avatarUrl){\r\n                      console.log(res.data.data.avatarUrl)\r\n                      this.touxiang = res.data.data.avatarUrl;\r\n                    //   this.$refs.touxiang.src= \"http://192.168.0.18:8080/zubei/users/img/9a0be563-2daf-4391-b2a3-27485e251849.jpg\";\r\n                      console.log(this.touxiang);\r\n                  }else{\r\n                      this.touxiang = require(\"@/assets/image/touxiang.jpg\");\r\n                  }\r\n            })\r\n                // this.touxiang = res.data.pic.replace(/public/,'http://192.168.0.24:8080');  //不需要配置代理 \r\n                // localStorage.avatar = this.touxiang;\r\n            })\r\n\r\n            // processData: false,//默认情况下，通过data选项传递进来的数据，如果是一个对象(技术上讲只要不是字符串)，都会处理转化成一个查询字符串，以配合默认内容类型 \"application/x-www-form-urlencoded\"。如果要发送 DOM 树信息或其它不希望转换的信息，请设置为 false。\r\n            // contentType: false,//数据编码格式不使用jquery的方式 为了避免 JQuery 对其操作，从而失去分界符，而使服务器不能正常解析文件。data:formData,\r\n        }\r\n    },\r\n    mounted(){\r\n        // if(localStorage.avatar){\r\n        //     this.touxiang = localStorage.avatar;\r\n        // }else{\r\n        //     // 使用默认 \r\n        //     this.touxiang = require(\"@/assets/images/img4.jpg\");\r\n        // }\r\n        this.$axios.post(\"/user/info\").then(res=>{\r\n            console.log(res.data.data.avatarUrl)\r\n                  if(res.data.data.avatarUrl){\r\n                      console.log(res.data.data.avatarUrl)\r\n                      this.touxiang = res.data.data.avatarUrl;\r\n                    //   this.$refs.touxiang.src= \"http://192.168.0.18:8080/zubei/users/img/9a0be563-2daf-4391-b2a3-27485e251849.jpg\";\r\n                      console.log(this.touxiang);\r\n                  }else{\r\n                      this.touxiang = require(\"@/assets/image/touxiang.jpg\");\r\n                  }\r\n            })\r\n        \r\n    }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n/* .photo{\r\n    height: 2rem;\r\n} */\r\n.userImg{\r\n     width: 0.54rem;\r\n     height: 0.54rem;\r\n     border-radius: 50%;\r\n     float: right;\r\n     margin-right: 0.12rem;\r\n }\r\n.touxiang{\r\n    width:0.8rem;\r\n    height:0.8rem;\r\n    border-radius: 50%;\r\n    margin-top: 0.1rem\r\n}\r\n\r\n.hiddenInput{\r\n    display: none;\r\n} \r\n</style>\r\n\r\n"]}]}